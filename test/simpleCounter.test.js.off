
// Підключаємо бібліотеку Chai — вона потрібна для перевірок (expect, to.equal, to.be.reverted тощо)
const { expect } = require("chai");

// Підключаємо об’єкт ethers із Hardhat — через нього ми працюємо з контрактами, мережами і користувачами
const { ethers } = require("hardhat");

// Починаємо групу тестів. "SimpleCounter" — це просто назва, щоб знати, що саме тестуємо
describe("SimpleCounter", function () {

    // Описуємо один конкретний тестовий сценарій (одна поведінка)
    it("should save number correctly", async function () {

        // Отримуємо тестові акаунти з Hardhat Network
        // Це масив об’єктів Signer — користувачів, які можуть підписувати транзакції
        // Беремо тільки першого користувача і називаємо його user1
        const [user1] = await ethers.getSigners();

        // Створюємо "фабрику" контрактів — шаблон, з якого можна деплоїти екземпляри контракту SimpleCounter
        // У дужках вказуємо назву контракту так, як вона записана в .sol файлі
        const SimpleCounter = await ethers.getContractFactory("SimpleCounter");

        // Деплоїмо (розгортаємо) контракт у локальну тестову мережу Hardhat
        // Цей рядок створює транзакцію, яка "публікує" контракт у мережі
        const counter = await SimpleCounter.deploy();

        // Чекаємо, поки контракт реально створиться і з’явиться в блокчейні
        // Після цього в нього з’являється адреса, і можна викликати його функції
        await counter.waitForDeployment();



        // Викликаємо функцію saveNumber(10) від імені користувача user1
        await counter.connect(user1).saveNumber(10);

        // Зчитуємо, яке число тепер збережено у мапінгу для user1
        const value = await counter.numbers(user1.address);

        // Перевіряємо: чи справді збережене число дорівнює 10
        expect(value).to.equal(10n);
    });
});



const { expect } = require("chai");
const { ethers } = require("hardhat");

describe("SimpleCounter", function () {
    let counter;  // тут ми оголошуємо змінну, щоб була доступна у всіх тестах
    let user1;

    // beforeEach запускається перед кожним тестом
    beforeEach(async function () {
        // Отримуємо користувачів
        [user1] = await ethers.getSigners();

        // Створюємо фабрику контракту
        const SimpleCounter = await ethers.getContractFactory("SimpleCounter");

        // Деплоїмо контракт
        counter = await SimpleCounter.deploy();

        // Чекаємо поки він з’явиться у мережі
        await counter.waitForDeployment();
    });

    // ✅ Перший тест — перевіряє збереження числа
    it("should save number correctly", async function () {
        await counter.connect(user1).saveNumber(10);
        const value = await counter.numbers(user1.address);
        expect(value).to.equal(10n);
    });

    // ✅ Другий тест — перевіряє віднімання
    it("should subtract number correctly", async function () {
        // Спочатку збережемо число 10
        await counter.connect(user1).saveNumber(10);

        // Віднімемо 4
        await counter.connect(user1).minusNumber(4);

        // Тепер у мапінгу має бути 6
        const value = await counter.numbers(user1.address);
        expect(value).to.equal(6n);
    });
});